addDataFrame(df, sheet=sheet, row.names=FALSE)
}
lapply(seq_along(table_dfs), function(x) add_dataframes(x))
saveWorkbook(wb, "pc_analysis.xlsx")
table_dfs <- c()
for (i in 1:length(signatures_noseqerr)){
pc_tosee <- paste("PC", as.character(i), sep = "")
table_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(desc(Coefficient)) %>% filter(Signature %in% signatures_aetiology)
table_dfs <- c(table_dfs, table_data)
plot_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(Coefficient) %>% filter(Signature %in% signatures_aetiology)
sig_order <- plot_data$Signature
sig_plot <- ggplot(plot_data, aes(x=factor(Signature, levels = sig_order), y=Coefficient, fill=Coefficient)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(midpoint=0, low="blue", mid="#faedcd",
high="red") +
xlab("Signature") +
ylab("Coefficient") +
labs(fill="Coefficient") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial", angle = 90, vjust = 0.5),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 8, family = "Arial"),
legend.title = element_text(size = 7, family = "Arial"),
legend.text = element_text(size = 6, family = "Arial"),
legend.key.height = unit(3, "mm"),
legend.key.width = unit(3, "mm"),
legend.box.margin = margin(-10,-10,-10,-10),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
out_file <- paste(base_path, pc_tosee, "_sorted_signatures.png", sep="")
ggsave(out_file, plot = sig_plot, dpi = 1200, width = 50, height = 115, units = "mm")
}
View(table_dfs)
wb <- createWorkbook(type="xlsx")
for (i in 1:length(signatures_noseqerr)){
pc_tosee <- paste("PC", as.character(i), sep = "")
table_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(desc(Coefficient)) %>% filter(Signature %in% signatures_aetiology)
sheet <- createSheet(wb, pc_tosee)
addDataFrame(table_data, sheet = sheet, row.names = FALSE)
plot_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(Coefficient) %>% filter(Signature %in% signatures_aetiology)
sig_order <- plot_data$Signature
sig_plot <- ggplot(plot_data, aes(x=factor(Signature, levels = sig_order), y=Coefficient, fill=Coefficient)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(midpoint=0, low="blue", mid="#faedcd",
high="red") +
xlab("Signature") +
ylab("Coefficient") +
labs(fill="Coefficient") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial", angle = 90, vjust = 0.5),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 8, family = "Arial"),
legend.title = element_text(size = 7, family = "Arial"),
legend.text = element_text(size = 6, family = "Arial"),
legend.key.height = unit(3, "mm"),
legend.key.width = unit(3, "mm"),
legend.box.margin = margin(-10,-10,-10,-10),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
out_file <- paste(base_path, pc_tosee, "_sorted_signatures.png", sep="")
ggsave(out_file, plot = sig_plot, dpi = 1200, width = 50, height = 115, units = "mm")
}
saveWorkbook(wb, "pc_analysis.xlsx")
library(readxl)
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file, skip = c(1,2,3,9,13,19,21,27,35))
aetiologies <- read_excel(aetiology_file)
aetiologies
aetiologies %>% filter(!row_number() %in% c(1,2,3,9,13,19,21,27,35))
aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
View(aetiologies)
colnames(aetiologies)
rename(aetiologies, old_cols = new_cols)
old_cols <- colnames(aetiologies)
new_cols <- c("Signature", "Aetiology")
rename(aetiologies, old_cols = new_cols)
rename(aetiologies, all_of(old_cols = new_cols))
old_cols <- colnames(aetiologies)
rename(aetiologies, all_of(get(old_cols) = new_cols))
get(old_cols)
rename(aetiologies, get(old_cols[1]) = new_cols[1])
colnames(aetiologies)
rename(aetiologies, "Table S1. SBS aetiology category" = new_cols[1])
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file)
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
rename(aetiologies, "Table S1. SBS aetiology category" = new_cols[1])
rename(aetiologies, "Signature" = "Table S1. SBS aetiology category")
rename(aetiologies, all_of(new_cols) = old_cols)
rename(aetiologies, all_of(new_cols = old_cols))
rename(aetiologies, new_cols[1] = old_cols[1])
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file)
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
old_cols <- colnames(aetiologies)
new_cols <- c("Signature", "Aetiology")
rename(aetiologies, new_cols[1] = old_cols[1])
rename(aetiologies, new_cols[2] = old_cols[2])
new_cols[1]
old_cols[1]
rename(aetiologies, get(new_cols[1]) = get(old_cols[1]))
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file)
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
colnames(aetiologies)[1] = "Signature"
colnames(aetiologies)[2] = "Aetiology"
aetiologies
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>% filter(Signature %in% signatures_aetiology)
table_data$Aetiology <- aetiologies
table_data
table_data$Aetiology <- aetiologies$Aetiology
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>% filter(Signature %in% signatures_aetiology)
table_data$Aetiology <- aetiologies$Aetiology
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>% filter(Signature %in% signatures_aetiology) %>% mutate(Signature = fct_reorder(Signature, aetiologies$Aetiology))
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>% filter(Signature %in% signatures_aetiology) %>% mutate(Signature = fct_reorder(Signature, aetiologies$Aetiology)) %>% arrange(Signature)
table_data
# read file
pc_matrix_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_matrix.csv", sep="")
pc_matrix <- read.csv(pc_matrix_file)
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file)
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
colnames(aetiologies)[1] = "Signature"
colnames(aetiologies)[2] = "Aetiology"
aetiologies
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, aetiologies$Signature)) %>%
arrange(Signature)
table_data$Aetiology <- aetiologies$Aetiology
# read file
pc_matrix_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_matrix.csv", sep="")
pc_matrix <- read.csv(pc_matrix_file)
aetiology_file <- paste(base_path, "Table_S1.xlsx", sep="")
aetiologies <- read_excel(aetiology_file)
aetiologies <- aetiologies %>% filter(!row_number() %in% c(1,2,8,12,18,20,26,34))
colnames(aetiologies)[1] = "Signature"
colnames(aetiologies)[2] = "Aetiology"
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, aetiologies$Signature)) %>%
arrange(Signature)
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, aetiologies$Signature))
pc_matrix <- read.csv(pc_matrix_file)
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, aetiologies$Signature))
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, signatures_aetiology)) %>%
arrange(Signature)
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = fct_reorder(Signature, signatures_aetiology)) %>%
arrange(desc(Signature))
table_data
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = factor(Signature, signatures_aetiology)) %>%
arrange(Signature)
pc_matrix <- read.csv(pc_matrix_file)
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = factor(Signature, signatures_aetiology)) %>%
arrange(Signature)
table_data
pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology)
table_data$Aetiology <- aetiologies$Aetiology
table_data
for (i in 1:length(signatures_noseqerr)){
pc_tosee <- paste("PC", as.character(i), sep = "")
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = factor(Signature, signatures_aetiology)) %>%
arrange(Signature)
table_data$Aetiology <- aetiologies$Aetiology
sheet <- createSheet(wb, pc_tosee)
addDataFrame(table_data, sheet = sheet, row.names = FALSE)
plot_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(Coefficient) %>% filter(Signature %in% signatures_aetiology)
sig_order <- plot_data$Signature
sig_plot <- ggplot(plot_data, aes(x=factor(Signature, levels = sig_order), y=Coefficient, fill=Coefficient)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(midpoint=0, low="blue", mid="#faedcd",
high="red") +
xlab("Signature") +
ylab("Coefficient") +
labs(fill="Coefficient") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial", angle = 90, vjust = 0.5),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 8, family = "Arial"),
legend.title = element_text(size = 7, family = "Arial"),
legend.text = element_text(size = 6, family = "Arial"),
legend.key.height = unit(3, "mm"),
legend.key.width = unit(3, "mm"),
legend.box.margin = margin(-10,-10,-10,-10),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
out_file <- paste(base_path, pc_tosee, "_sorted_signatures.png", sep="")
ggsave(out_file, plot = sig_plot, dpi = 1200, width = 50, height = 115, units = "mm")
}
wb <- createWorkbook(type="xlsx")
for (i in 1:length(signatures_noseqerr)){
pc_tosee <- paste("PC", as.character(i), sep = "")
table_data <- pc_matrix %>% filter(Principal_component == "PC3") %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = factor(Signature, signatures_aetiology)) %>%
arrange(Signature)
table_data$Aetiology <- aetiologies$Aetiology
sheet <- createSheet(wb, pc_tosee)
addDataFrame(table_data, sheet = sheet, row.names = FALSE)
plot_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(Coefficient) %>% filter(Signature %in% signatures_aetiology)
sig_order <- plot_data$Signature
sig_plot <- ggplot(plot_data, aes(x=factor(Signature, levels = sig_order), y=Coefficient, fill=Coefficient)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(midpoint=0, low="blue", mid="#faedcd",
high="red") +
xlab("Signature") +
ylab("Coefficient") +
labs(fill="Coefficient") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial", angle = 90, vjust = 0.5),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 8, family = "Arial"),
legend.title = element_text(size = 7, family = "Arial"),
legend.text = element_text(size = 6, family = "Arial"),
legend.key.height = unit(3, "mm"),
legend.key.width = unit(3, "mm"),
legend.box.margin = margin(-10,-10,-10,-10),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
out_file <- paste(base_path, pc_tosee, "_sorted_signatures.png", sep="")
ggsave(out_file, plot = sig_plot, dpi = 1200, width = 50, height = 115, units = "mm")
}
wb_file <- paste(base_path, "Table_S2.xlsx", sep = "")
saveWorkbook(wb, wb_file)
wb <- createWorkbook(type="xlsx")
for (i in 1:length(signatures_noseqerr)){
pc_tosee <- paste("PC", as.character(i), sep = "")
table_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>%
filter(Signature %in% signatures_aetiology) %>%
mutate(Signature = factor(Signature, signatures_aetiology)) %>%
arrange(Signature)
table_data$Aetiology <- aetiologies$Aetiology
table_data <- table_data %>% arrange(desc(Coefficient))
sheet <- createSheet(wb, pc_tosee)
addDataFrame(table_data, sheet = sheet, row.names = FALSE)
plot_data <- pc_matrix %>% filter(Principal_component == pc_tosee) %>% arrange(Coefficient) %>% filter(Signature %in% signatures_aetiology)
sig_order <- plot_data$Signature
sig_plot <- ggplot(plot_data, aes(x=factor(Signature, levels = sig_order), y=Coefficient, fill=Coefficient)) +
geom_col() +
coord_flip() +
scale_fill_gradient2(midpoint=0, low="blue", mid="#faedcd",
high="red") +
xlab("Signature") +
ylab("Coefficient") +
labs(fill="Coefficient") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial", angle = 90, vjust = 0.5),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 8, family = "Arial"),
legend.title = element_text(size = 7, family = "Arial"),
legend.text = element_text(size = 6, family = "Arial"),
legend.key.height = unit(3, "mm"),
legend.key.width = unit(3, "mm"),
legend.box.margin = margin(-10,-10,-10,-10),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
out_file <- paste(base_path, pc_tosee, "_sorted_signatures.png", sep="")
ggsave(out_file, plot = sig_plot, dpi = 1200, width = 50, height = 115, units = "mm")
}
wb_file <- paste(base_path, "Table_S2.xlsx", sep = "")
saveWorkbook(wb, wb_file)
library(tidyverse)
library(dplyr)
library(ggplot2)
# file directories
base_path <- "C:/Users/CEEL-PC-005/Desktop/Joon/Final_scripts/Simple_robustness_analysis_of_cds_files/"
# read file
pca_shoulder_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.csv", sep="")
pca_shoulder <- read.csv(pca_shoulder_file)
pca_shoulder
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_line()
shoulder_plot
library(extrafont)
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_line() +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_line() +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point() +
geom_line() +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = pca_plot, dpi=1200, width = 75, height = 55, units = "mm")
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 1, shape = ".", stroke = 0.01) +
geom_line() +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 1, shape = ".")+#, stroke = 0.01) +
geom_line() +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 3, shape = ".")+#, stroke = 0.01) +
geom_line() +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 3)+#, stroke = 0.01) +
geom_line() +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 3) + #, stroke = 0.01) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 10) + #, stroke = 0.01) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 5) + #, stroke = 0.01) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 3) + #, stroke = 0.01) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 0.5) + #, stroke = 0.01) +
geom_line(linewidth = 1) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
shoulder_plot
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 0.5) + #, stroke = 0.01) +
geom_line(linewidth = 0.25) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
shoulder_plot <- ggplot(pca_shoulder, aes(x=N_components, y=Cumulative_explained_variance*100)) +
geom_point(size = 0.35) + #, stroke = 0.01) +
geom_line(linewidth = 0.25) +
scale_x_continuous(breaks = seq(10, 60, by = 10)) +
xlab("Number of principa components") +
ylab("Cumulative explained variance (%)") +
theme_light() +
theme(
axis.text.x = element_text(size = 6, family = "Arial"),
axis.text.y = element_text(size = 6, family = "Arial"),
axis.title = element_text(size = 7, family = "Arial")
)
out_file <- paste(base_path, "all_gencode_noseqerr_signatures_PCA_shoulder.png", sep="")
ggsave(out_file, plot = shoulder_plot, dpi=1200, width = 75, height = 55, units = "mm")
